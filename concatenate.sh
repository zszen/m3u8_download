#!/bin/sh

echo 'Concatenating all pieces...'

ulimit -n 2560

# cat $(ls -1 1/*.ts | sort -n ) > all.ts

# echo 'Repackaging...'
# ffmpeg -i all.ts -acodec copy -vcodec copy -bsf:a aac_adtstoasc $1


ffmpeg -i "concat:converted/1.ts|converted/2.ts|converted/3.ts|converted/4.ts|converted/5.ts|converted/6.ts|converted/7.ts|converted/8.ts|converted/9.ts|converted/10.ts|converted/11.ts|converted/12.ts|converted/13.ts|converted/14.ts|converted/15.ts|converted/16.ts|converted/17.ts|converted/18.ts|converted/19.ts|converted/20.ts|converted/21.ts|converted/22.ts|converted/23.ts|converted/24.ts|converted/25.ts|converted/26.ts|converted/27.ts|converted/28.ts|converted/29.ts|converted/30.ts|converted/31.ts|converted/32.ts|converted/33.ts|converted/34.ts|converted/35.ts|converted/36.ts|converted/37.ts|converted/38.ts|converted/39.ts|converted/40.ts|converted/41.ts|converted/42.ts|converted/43.ts|converted/44.ts|converted/45.ts|converted/46.ts|converted/47.ts|converted/48.ts|converted/49.ts|converted/50.ts|converted/51.ts|converted/52.ts|converted/53.ts|converted/54.ts|converted/55.ts|converted/56.ts|converted/57.ts|converted/58.ts|converted/59.ts|converted/60.ts|converted/61.ts|converted/62.ts|converted/63.ts|converted/64.ts|converted/65.ts|converted/66.ts|converted/67.ts|converted/68.ts|converted/69.ts|converted/70.ts|converted/71.ts|converted/72.ts|converted/73.ts|converted/74.ts|converted/75.ts|converted/76.ts|converted/77.ts|converted/78.ts|converted/79.ts|converted/80.ts|converted/81.ts|converted/82.ts|converted/83.ts|converted/84.ts|converted/85.ts|converted/86.ts|converted/87.ts|converted/88.ts|converted/89.ts|converted/90.ts|converted/91.ts|converted/92.ts|converted/93.ts|converted/94.ts|converted/95.ts|converted/96.ts|converted/97.ts|converted/98.ts|converted/99.ts|converted/100.ts|converted/101.ts|converted/102.ts|converted/103.ts|converted/104.ts|converted/105.ts|converted/106.ts|converted/107.ts|converted/108.ts|converted/109.ts|converted/110.ts|converted/111.ts|converted/112.ts|converted/113.ts|converted/114.ts|converted/115.ts|converted/116.ts|converted/117.ts|converted/118.ts|converted/119.ts|converted/120.ts|converted/121.ts|converted/122.ts|converted/123.ts|converted/124.ts|converted/125.ts|converted/126.ts|converted/127.ts|converted/128.ts|converted/129.ts|converted/130.ts|converted/131.ts|converted/132.ts|converted/133.ts|converted/134.ts|converted/135.ts|converted/136.ts|converted/137.ts|converted/138.ts|converted/139.ts|converted/140.ts|converted/141.ts|converted/142.ts|converted/143.ts|converted/144.ts|converted/145.ts|converted/146.ts|converted/147.ts|converted/148.ts|converted/149.ts|converted/150.ts|converted/151.ts|converted/152.ts|converted/153.ts|converted/154.ts|converted/155.ts|converted/156.ts|converted/157.ts|converted/158.ts|converted/159.ts|converted/160.ts|converted/161.ts|converted/162.ts|converted/163.ts|converted/164.ts|converted/165.ts|converted/166.ts|converted/167.ts|converted/168.ts|converted/169.ts|converted/170.ts|converted/171.ts|converted/172.ts|converted/173.ts|converted/174.ts|converted/175.ts|converted/176.ts|converted/177.ts|converted/178.ts|converted/179.ts|converted/180.ts|converted/181.ts|converted/182.ts|converted/183.ts|converted/184.ts|converted/185.ts|converted/186.ts|converted/187.ts|converted/188.ts|converted/189.ts|converted/190.ts|converted/191.ts|converted/192.ts|converted/193.ts|converted/194.ts|converted/195.ts|converted/196.ts|converted/197.ts|converted/198.ts|converted/199.ts|converted/200.ts|converted/201.ts|converted/202.ts|converted/203.ts|converted/204.ts|converted/205.ts|converted/206.ts|converted/207.ts|converted/208.ts|converted/209.ts|converted/210.ts|converted/211.ts|converted/212.ts|converted/213.ts|converted/214.ts|converted/215.ts|converted/216.ts|converted/217.ts|converted/218.ts|converted/219.ts|converted/220.ts|converted/221.ts|converted/222.ts|converted/223.ts|converted/224.ts|converted/225.ts|converted/226.ts|converted/227.ts|converted/228.ts|converted/229.ts|converted/230.ts|converted/231.ts|converted/232.ts|converted/233.ts|converted/234.ts|converted/235.ts|converted/236.ts|converted/237.ts|converted/238.ts|converted/239.ts|converted/240.ts|converted/241.ts|converted/242.ts|converted/243.ts|converted/244.ts|converted/245.ts|converted/246.ts|converted/247.ts|converted/248.ts|converted/249.ts|converted/250.ts|converted/251.ts|converted/252.ts|converted/253.ts|converted/254.ts|converted/255.ts|converted/256.ts|converted/257.ts|converted/258.ts|" -acodec copy -vcodec copy -absf aac_adtstoasc out.mp4
